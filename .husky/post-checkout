#!/bin/sh
# Post-checkout hook: Clear cache when switching branches to prevent stale cache issues

# Exit early if this is a file checkout, not a branch checkout
if [ "$3" = "0" ]; then
  exit 0
fi

echo "üîÑ Branch checkout detected..."

# Check if critical files have changed between old and new branches
if git diff --name-only "$1" "$2" | grep -qE "(package\.json|next\.config\.|tailwind\.config\.|tsconfig\.json)"; then
  echo "üì¶ Critical configuration files changed, clearing cache..."
  rm -rf .next tsconfig.tsbuildinfo
  echo "‚úÖ Cache cleared successfully"
else
  echo "‚ÑπÔ∏è  No critical config changes detected, cache preserved"
fi